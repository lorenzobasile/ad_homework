#ifndef _graph
#define _graph

//node of the linked list of neighbours, containing index of the node, cost of the link
//and pointer to next neighbour
typedef struct listnode{
    int node;
    int cost;
    struct listnode* next;
}listnode;

//pointer to the first element of the linked list
typedef listnode* ll;


//utility function that tells if a certain node is in a linked list
int in(ll list, int index){
    ll temp=list;
    while(temp!=NULL){
        if(temp->node==index) return 1;
        temp=temp->next;
    }
    return 0;
}

//struct graph: contains a size and an array of linked lists of neighbours
typedef struct graph {
    size_t size;
    ll* adj;
}graph;

void graph_random_init(graph* G, const size_t size, const unsigned int max_cost, const unsigned int max_neighbours){
    G->size = size;
    G->adj = malloc(sizeof(ll)*G->size);
    for(int i=0; i<G->size; i++){
        G->adj[i]=NULL;
        int num_of_neighbours=rand()%max_neighbours;
        ll temp;
        for(int j=0; j<num_of_neighbours; j++){
            temp=malloc(sizeof(listnode));
            int candidate;
            do{
                candidate=rand()%G->size;
            } while(candidate==i || in(G->adj[i], candidate));
            temp->node=candidate;
            temp->cost=rand()%max_cost;
            temp->next=G->adj[i];
            G->adj[i]=temp;
        }
        temp=G->adj[i];
        /*while(temp!=NULL){
            printf("%d -> %d, cost: %d \n", i, temp->node, temp->cost);
            temp=temp->next;
        }*/
    }
}
void deallocate_graph(graph* G){
    for(int i=0; i<G->size; i++){
        free(G->adj[i]);
    }
    free(G->adj);
}

#endif
